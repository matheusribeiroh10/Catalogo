<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Cat√°logo Digital</title>
<style>
body {font-family: Arial, sans-serif; margin:0; background:#f7f7f7; text-align:center;}
header {background:#2b7bba; color:white; padding:10px; font-size:18px; font-weight:bold;
        position:sticky; top:0; z-index:10; display:flex; justify-content:space-between;
        align-items:center;}
#versao {
    background:#ffcc00; color:#000; font-weight:bold;
    padding:4px 8px; border-radius:8px; font-size:13px; border:1px solid #333;
}
#total {font-size:15px; font-weight:bold;}
#marcas-container {display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin:10px;}
.marca-btn {
    flex: 1 1 120px;
    min-width: 130px;
    max-width: 160px;
    padding:10px;
    border:none;
    border-radius:10px;
    font-size:14px;
    background:#2b7bba;
    color:white;
    cursor:pointer;
    word-wrap:break-word;
    white-space:normal;
}
.marca-btn.tudo {background:#25d366; font-weight:bold;}
#telefone-container {
    margin:15px auto 0 auto;
    display:flex; justify-content:center; align-items:center; gap:8px; flex-wrap:wrap;
}
#telefone-container span {font-weight:bold; color:#333;}
#telefone-container button {
    border:none; background:#2b7bba; color:white;
    border-radius:8px; padding:6px 10px; cursor:pointer;
}
#produtos-container {
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:12px;
    padding:12px;
    max-width:700px;
    margin:auto;
}
.produto {
    background:white;
    border-radius:12px;
    box-shadow:0 2px 5px rgba(0,0,0,0.1);
    padding:10px;
}
.produto img {
    width:100%; height:160px; object-fit:contain; border-radius:10px; background:#fff;
}
.qtd-container {
    display:flex; align-items:center; justify-content:center; margin-top:5px;
}
.qtd-container button {
    width:28px; height:28px; border:none; border-radius:6px;
    background:#2b7bba; color:white; font-size:18px; font-weight:bold; cursor:pointer;
}
.qtd-container input {
    width:40px; text-align:center; margin:0 5px; border:1px solid #ccc; border-radius:6px;
}
button#voltar {
    background:#e74c3c; color:white; border:none;
    padding:8px 12px; font-size:14px; border-radius:8px; cursor:pointer;
}
#btnCarrinho {
    background:white; color:#2b7bba; border:2px solid #2b7bba;
    font-size:16px; padding:10px 18px; border-radius:10px; font-weight:bold; cursor:pointer;
}
#tela-carrinho {padding:15px;}
.carrinho-item {
    background:white; border-radius:10px; margin:8px auto; padding:10px;
    box-shadow:0 2px 5px rgba(0,0,0,0.1); max-width:700px;
    display:flex; align-items:center; justify-content:space-between; gap:10px;
}
.carrinho-item img {width:60px; height:60px; border-radius:8px; object-fit:contain;}
.hidden {display:none;}
/* popup */
#popup {
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.6); display:flex; justify-content:center; align-items:center;
    z-index:100;
}
#popup-content {
    background:white; padding:20px; border-radius:10px; max-width:300px;
    text-align:center;
}
#popup input {
    width:90%; padding:6px; margin-top:8px;
    border:1px solid #ccc; border-radius:6px; text-align:center;
}
#popup button {
    margin-top:10px; background:#2b7bba; color:white;
    border:none; border-radius:8px; padding:8px 12px; cursor:pointer;
}
</style>
</head>
<body>

<header>
  <!-- üîß ATUALIZAR VERS√ÉO AQUI -->
  <span id="versao">v1.2</span>
  <button id="voltar" onclick="mostrarMarcas()">üîô Marcas</button>
  <div>Cat√°logo Digital<br><span id="total">Total: R$ 0,00</span></div>
  <button id="btnCarrinho" onclick="mostrarCarrinho()">üõí Carrinho</button>
</header>

<div id="tela-marcas">
  <div id="telefone-container"></div>
  <h3>Escolha uma Marca</h3>
  <div id="marcas-container">
    <button class="marca-btn tudo" onclick="mostrarProdutos('Tudo')">Tudo</button>
    <button class="marca-btn" onclick="mostrarProdutos('Bauducco')">Bauducco</button>
    <button class="marca-btn" onclick="mostrarProdutos('Danone')">Danone</button>
    <button class="marca-btn" onclick="mostrarProdutos('Divinitos')">Divinitos</button>
    <button class="marca-btn" onclick="mostrarProdutos('Elma Chips')">Elma Chips</button>
    <button class="marca-btn" onclick="mostrarProdutos('FRITOP')">FRITOP</button>
    <button class="marca-btn" onclick="mostrarProdutos('Frutap')">Frutap</button>
    <button class="marca-btn" onclick="mostrarProdutos('Kremoso')">Kremoso</button>
    <button class="marca-btn" onclick="mostrarProdutos('Nestl√©')">Nestl√©</button>
    <button class="marca-btn" onclick="mostrarProdutos('Oz')">Oz Pipocas</button>
    <button class="marca-btn" onclick="mostrarProdutos('Rebeka')">Rebeka Pudim</button>
    <button class="marca-btn" onclick="mostrarProdutos('Rei da Massa')">Rei da Massa</button>
    <button class="marca-btn" onclick="mostrarProdutos('Sacola')">Sacolas</button>
  </div>
</div>

<!-- POPUP DE CONTATO -->
<div id="popup" class="hidden" aria-hidden="true">
  <div id="popup-content">
    <h4>Informe seu n√∫mero de contato</h4>
    <input id="telefone-input" placeholder="(19) 99999-9999" maxlength="15" inputmode="numeric">
    <button id="btnSalvarContato">Salvar contato</button>
  </div>
</div>

<script>
/* ===== TELEFONE ===== */
let telefoneDigits = localStorage.getItem("telefone_digits") || "";
let telefoneDisplay = localStorage.getItem("telefone_display") || "";

/* M√°scara de digita√ß√£o */
document.addEventListener("input", (e) => {
  if (e.target.id === "telefone-input") {
    let v = e.target.value.replace(/\D/g, "");
    if (v.length > 11) v = v.slice(0, 11);
    if (v.length >= 7)
      e.target.value = `(${v.slice(0, 2)}) ${v.slice(2, 7)}-${v.slice(7)}`;
    else if (v.length > 2)
      e.target.value = `(${v.slice(0, 2)}) ${v.slice(2)}`;
    else e.target.value = v;
  }
});

function renderTelefone() {
  const el = document.getElementById("telefone-container");
  if (!el) return;
  el.innerHTML = telefoneDigits
    ? `<span>${telefoneDisplay}</span><button onclick="editarTelefone()">‚úèÔ∏è Editar</button>`
    : `<span style="color:#666;">Nenhum contato cadastrado</span> <button onclick="abrirPopup()">Cadastrar</button>`;
}

function abrirPopup() {
  const popup = document.getElementById("popup");
  popup.classList.remove("hidden");
  popup.style.display = "flex";
  popup.setAttribute("aria-hidden", "false");
  document.getElementById("telefone-input").focus();
}

function fecharPopup() {
  const popup = document.getElementById("popup");
  popup.classList.add("hidden");
  popup.style.display = "none";
  popup.setAttribute("aria-hidden", "true");
}

function salvarTelefone() {
  const inp = document.getElementById("telefone-input");
  const digits = inp.value.replace(/\D/g, "");
  if (digits.length < 10) return alert("N√∫mero inv√°lido! Use DDD + celular.");

  const ddd = digits.slice(0, 2);
  const corpo = digits.slice(2);
  const exib = corpo.length === 8
    ? `(${ddd}) ${corpo.slice(0, 4)}-${corpo.slice(4)}`
    : `(${ddd}) ${corpo.slice(0, 5)}-${corpo.slice(5)}`;

  telefoneDigits = digits;
  telefoneDisplay = exib;
  localStorage.setItem("telefone_digits", telefoneDigits);
  localStorage.setItem("telefone_display", telefoneDisplay);
  fecharPopup();
  renderTelefone();
}

function editarTelefone() {
  telefoneDigits = "";
  telefoneDisplay = "";
  localStorage.removeItem("telefone_digits");
  localStorage.removeItem("telefone_display");
  abrirPopup();
}

/* Evento seguro */
document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("btnSalvarContato").addEventListener("click", salvarTelefone);
  renderTelefone();
  if (!telefoneDigits) abrirPopup();
});
</script>


// --- PRODUTOS / CARRINHO ---
function mostrarProdutos(marca){
  document.getElementById("tela-marcas").classList.add("hidden");
  document.getElementById("tela-produtos").classList.remove("hidden");
  document.getElementById("titulo-marca").textContent=marca==="Tudo"?"Todos os Produtos":"Marca: "+marca;
  const c=document.getElementById("produtos-container");
  c.innerHTML="";
  produtos.filter(p=>marca==="Tudo"||p.marca===marca).forEach(p=>{
    c.innerHTML+=`
    <div class="produto">
      <img src="${p.imagem}">
      <h4>${p.descricao}</h4>
      <small>(${p.C√≥digo})</small>
      <p><b>R$ ${p.valor.toFixed(2)}</b></p>
      <div class="qtd-container">
        <button onclick="alterarQtd('${p.C√≥digo}',-1)">-</button>
        <input id="qtd-${p.C√≥digo}" value="${carrinho[p.C√≥digo]?.qtd||0}">
        <button onclick="alterarQtd('${p.C√≥digo}',1)">+</button>
      </div>
    </div>`;
  });
}
function mostrarMarcas(){
  document.getElementById("tela-produtos").classList.add("hidden");
  document.getElementById("tela-carrinho").classList.add("hidden");
  document.getElementById("tela-marcas").classList.remove("hidden");
}
function mostrarCarrinho(){
  document.getElementById("tela-marcas").classList.add("hidden");
  document.getElementById("tela-produtos").classList.add("hidden");
  document.getElementById("tela-carrinho").classList.remove("hidden");
  const c=document.getElementById("itens-carrinho");
  c.innerHTML="";
  if(Object.keys(carrinho).length===0){
    c.innerHTML="<p>Seu carrinho est√° vazio üõí</p>";
    document.getElementById("total-carrinho").textContent="Total: R$ 0,00";
    return;
  }
  for(let x in carrinho){
    const p=carrinho[x];
    c.innerHTML+=`
    <div class="carrinho-item">
      <img src="${p.imagem}">
      <div style="flex:1;text-align:left;">
        <b>${p.descricao}</b><br><small>(${p.C√≥digo})</small><br>
        <span>R$ ${p.valor.toFixed(2)}</span>
      </div>
      <div class="qtd-container">
        <button onclick="alterarQtd('${p.C√≥digo}',-1,true)">-</button>
        <input id="qtd-carrinho-${p.C√≥digo}" value="${p.qtd}">
        <button onclick="alterarQtd('${p.C√≥digo}',1,true)">+</button>
      </div>
    </div>`;
  }
  atualizarTotal();
}
function alterarQtd(cod,delta,emCarrinho=false){
  const p=produtos.find(x=>x.C√≥digo===cod);
  if(!p)return;
  let q=carrinho[cod]?.qtd||0;
  q+=delta; if(q<0)q=0;
  if(q>0)carrinho[cod]={...p,qtd:q}; else delete carrinho[cod];
  const i1=document.getElementById(`qtd-${cod}`);
  const i2=document.getElementById(`qtd-carrinho-${cod}`);
  if(i1)i1.value=q; if(i2)i2.value=q;
  atualizarTotal();
}
function atualizarTotal(){
  let t=0; for(let c in carrinho)t+=carrinho[c].valor*carrinho[c].qtd;
  document.getElementById("total").innerText="Total: R$ "+t.toFixed(2);
  const tc=document.getElementById("total-carrinho");
  if(tc)tc.innerText="Total: R$ "+t.toFixed(2);
}
function enviarWhatsApp(){
  if(Object.keys(carrinho).length===0)return alert("Nenhum item no pedido!");
  let msg="üõí *Pedido:*%0A";
  for(let c in carrinho){
    const p=carrinho[c];
    msg+=`‚Ä¢ ${p.descricao} (${p.C√≥digo}) - ${p.qtd} un.%0A`;
  }
  const tot=Object.values(carrinho).reduce((a,b)=>a+b.valor*b.qtd,0);
  msg+=`%0Aüí∞ *Total:* R$ ${tot.toFixed(2)}`;
  if(telefone) msg+=`%0Aüìû *Contato:* ${telefone}`;
  window.open("https://wa.me/5519992394899?text="+msg,"_blank");
}
</script>
</body>
</html>



